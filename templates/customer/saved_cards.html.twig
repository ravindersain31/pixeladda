{% extends 'base.html.twig' %}

{% block title %}
	Saved Payment Methods
{% endblock %}

{% block javascripts %}
	<script src="https://js.braintreegateway.com/web/dropin/1.39.1/js/dropin.min.js"></script>
{% endblock %}

{% block body %}
	{{ include('common/common_mobile_bar.html.twig', {
		commonBarText: 'Order Online Or Call Now',
		commonBarTele: '+1-877-958-1499'
	}) }}

	{{ include('customer/common/top_section.html.twig', {
		section: { name: 'Saved Payment Methods', active: true }
	}) }}

	<div class="saved-cards-section" data-controller="saved-braintree-cards">

		{{ include("customer/common/customer_details.html.twig") }}

		<div class="container customer-details saved-cards-container proof-order-container">
			<div class="common-account-pages-wrapper page-content">
				<div class="info-description alert text-center mb-4">
					You may store multiple payment methods and set one as the default to use on the checkout page.
					For questions please call <a href="tel:+1-877-958-1499">+1-877-958-1499</a>, message us on our <a href="javascript:void(Tawk_API.toggle())">Live Chat</a>, or email <a href="mailto:">{{storeInfo.storeEmail}}</a>
				</div>

				<div class="row saved-card-listing" data-saved-braintree-cards-target="list">
					{{ include('customer/saved-cards/_list.html.twig', { savedCards: savedCards }) }}
				</div>
			</div>

			{% component BootstrapModal with { id: 'savedCardModal'} %}
				{% block modal_full_content %}
					<div class="modal-header">
						<h5 class="modal-title">Add Credit Card</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" data-action="saved-braintree-cards#closeModal"></button>
					</div>

					<div class="modal-body">
						<div class="alert alert-danger d-none"
							data-saved-braintree-cards-target="errorBox">
							<span data-saved-braintree-cards-target="errorMessage"></span>
						</div>
						<div id="braintree-dropin"
							data-saved-braintree-cards-target="dropin"></div>
						<div class="modal-actions d-flex gap-2 justify-content-end">
							<button type="button" class="btn btn-primary btn-ysp-outline btn-sm" data-bs-dismiss="modal" data-action="saved-braintree-cards#closeModal">Cancel</button>
							<button
								class="btn btn-primary btn-sm btn-ysp-outline d-flex align-items-center"
								data-action="saved-braintree-cards#save"
								data-saved-braintree-cards-target="saveButton">
									<span class="spinner-border spinner-border-sm me-2 d-none savedBraintreeCardsLoader" role="status"></span>
									Save Card
							</button>
						</div>
					</div>
				{% endblock %}
			{% endcomponent %}
		</div>
	</div>
{% endblock %}
