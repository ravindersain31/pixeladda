<div {{ attributes }}>
    <!-- Modal Header -->
    <div class="modal-header">
        <h5 class="modal-title text-primary" id="formModalLabel">
            Update Monthly Data {{ monthlyCogsReport.date | date('M Y') }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
        {{ form_start(form, {
            attr: {
                'novalidate': true,
                'data-action': 'live#action:prevent',
                'data-live-action-param': 'prevent|files|save',
                'class': 'needs-validation'
            }
        }) }}
        {{ form_errors(form) }}

        <!-- Payroll Cost Section -->
        <div class="mb-3">
            <label for="{{ form.payrollCost.vars.id }}" class="form-label fw-bold">Payroll Cost</label>
            <p class="text-muted small mb-1">Enter the total payroll cost for this month.</p>
            {{ form_widget(form.payrollCost, { attr: { class: 'form-control', placeholder: 'Enter payroll cost' } }) }}
            <div class="invalid-feedback">{{ form_errors(form.payrollCost) }}</div>
        </div>

        <!-- Fixed Cost Section -->
        <div class="mb-3">
            <label for="{{ form.fixedCost.vars.id }}" class="form-label fw-bold">Fixed Cost</label>
            <p class="text-muted small mb-1">Enter the fixed operational costs for this month.</p>
            {{ form_widget(form.fixedCost, { attr: { class: 'form-control', placeholder: 'Enter fixed cost' } }) }}
            <div class="invalid-feedback">{{ form_errors(form.fixedCost) }}</div>
        </div>

        <!-- Notes Section -->
        <div class="mb-3">
            <label for="{{ form.notes.vars.id }}" class="form-label fw-bold">Notes</label>
            <p class="text-muted small mb-1">Add any additional notes or comments about this month's data.</p>
            {{ form_widget(form.notes, { attr: { class: 'form-control', rows: 3, placeholder: 'Add any additional notes here...' } }) }}
            <div class="invalid-feedback">{{ form_errors(form.notes) }}</div>
        </div>

        <!-- Line Items Section -->
        <div class="mb-0">
            <h6 class="fw-bold mb-2">Line Items</h6>
            <p class="text-muted small mb-2">Add key-value pairs to represent specific line items for this month.</p>
            {% for item in form.lineItems %}
                <div class="d-flex align-items-center gap-2 mb-2">
                    {{ form_widget(item.key, { 
                        attr: { 
                            class: 'flex-grow-1 form-control form-control-sm', 
                            placeholder: 'Key (e.g., Rent, Utilities)' 
                        } 
                    }) }}
                    {{ form_widget(item.value, { 
                        attr: { 
                            class: 'flex-grow-1 form-control form-control-sm', 
                            placeholder: 'Value (e.g., $1000)' 
                        } 
                    }) }}
                    {{ form_widget(item.vars.button_delete, { attr: { class: 'btn btn-danger btn-sm' } }) }}
                </div>
            {% endfor %}
            <div class="text-end mt-2">
                {{ form_widget(form.lineItems.vars.button_add, { attr: { class: 'btn btn-success btn-sm' } }) }}
            </div>
        </div>
    </div>

    <!-- Modal Footer -->
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary btn-sm d-flex align-items-center gap-2" data-loading="action(save)|addAttribute(disabled)" aria-disabled="true">
            <div class="spinner-border spinner-border-sm text-light" role="status" hidden></div>
            <i class="fas fa-save"></i>
            <span>Update</span>
        </button>
    </div>
</div>